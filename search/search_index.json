{
    "docs": [
        {
            "location": "/", 
            "text": "Markdown\n\n\nmkdocs\n\n\n\n\nmkdocs new [dir-name]\n - Create a new project.\n\n\nmkdocs serve\n - Start the live-reloading docs server.\n\n\nmkdocs build\n - Build the documentation site.\n\n\nmkdocs help\n - Print this help message.\n\n\n\n\nmkdocs build --clean\n in mkdocs directory\n\n\ngit\n\n\ngit clone https://github.com/user/repository.git\n\n\ngit init\n\n\ngit push origin master --force\n\n\nProject layout\n\n\nmkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n\n\n\nwhile true; do curl 10.8.8.204; sleep 1; echo \"\\n\"; done", 
            "title": "Markdown"
        }, 
        {
            "location": "/#markdown", 
            "text": "", 
            "title": "Markdown"
        }, 
        {
            "location": "/#mkdocs", 
            "text": "mkdocs new [dir-name]  - Create a new project.  mkdocs serve  - Start the live-reloading docs server.  mkdocs build  - Build the documentation site.  mkdocs help  - Print this help message.   mkdocs build --clean  in mkdocs directory", 
            "title": "mkdocs"
        }, 
        {
            "location": "/#git", 
            "text": "git clone https://github.com/user/repository.git  git init  git push origin master --force", 
            "title": "git"
        }, 
        {
            "location": "/#project-layout", 
            "text": "mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n\n\n\nwhile true; do curl 10.8.8.204; sleep 1; echo \"\\n\"; done", 
            "title": "Project layout"
        }, 
        {
            "location": "/Firewall/", 
            "text": "#!/bin/bash\n\nexport IPT=\"iptables\"\n\n# \u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\nexport WAN=enp1s0\nexport WAN_IP=pub_ip/27\n\n# \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0435\u0442\u044c\nexport LAN1=enp1s0:1\nexport LAN1_IP_RANGE=10.10.0.0/24\n#export LAN2=mgmt11\n#export LAN2_IP_RANGE=172.16.0.0/28\n#export LAN3=wlxe84e063c9d5f\n#export LAN3_IP_RANGE=192.168.43.0/24\n\n# \u041e\u0447\u0438\u0449\u0430\u0435\u043c \u043f\u0440\u0430\u0432\u0438\u043b\u0430\n$IPT -F\n$IPT -F -t nat\n$IPT -F -t mangle\n$IPT -X\n$IPT -t nat -X\n$IPT -t mangle -X\n\n# \u0417\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u043c \u0432\u0441\u0435, \u0447\u0442\u043e \u043d\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e\n$IPT -P INPUT DROP\n$IPT -P OUTPUT DROP\n$IPT -P FORWARD DROP\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c localhost \u0438 \u043b\u043e\u043a\u0430\u043b\u043a\u0443                                                                                                                       \n$IPT -A INPUT -i lo -j ACCEPT                                                                                                                         \n$IPT -A INPUT -i $LAN1 -j ACCEPT                                                                                                                      \n#$IPT -A INPUT -i $LAN2 -j ACCEPT                                                                                                                                                                                                                                          \n$IPT -A OUTPUT -o lo -j ACCEPT                                                                                                                        \n$IPT -A OUTPUT -o $LAN1 -j ACCEPT                                                                                                                     \n#$IPT -A OUTPUT -o $LAN2 -j ACCEPT\n\n\n\n# \u0420\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043f\u0438\u043d\u0433\u0438                                                                                                                                      \n$IPT -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT                                                                                                \n$IPT -A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT                                                                                   \n$IPT -A INPUT -p icmp --icmp-type time-exceeded -j ACCEPT                                                                                             \n$IPT -A INPUT -p icmp --icmp-type echo-request -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430                                                                                                         \n$IPT -A OUTPUT -o $WAN -j ACCEPT                                                                                                                      \n#$IPT -A OUTPUT -o $LAN3 -j ACCEPT                                                                                                                    \n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0432\u0441\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430                                                                                                          \n$IPT -A INPUT -i $WAN -j ACCEPT                                                                                                                                                                                                              \n#$IPT -A OUTPUT -o $LAN3 -j ACCEPT\n\n# \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f                                                                                                                                                                                                        \n$IPT -A INPUT -p all -m state --state ESTABLISHED,RELATED -j ACCEPT                                                                                                                                                                          \n$IPT -A OUTPUT -p all -m state --state ESTABLISHED,RELATED -j ACCEPT                                                                                                                                                                         \n$IPT -A FORWARD -p all -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# \u041e\u0442\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c \u043d\u0435\u043e\u043f\u043e\u0437\u043d\u0430\u043d\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b                                                                                                                                                                                                            \n$IPT -A INPUT -m state --state INVALID -j DROP                                                                                                                                                                                               \n$IPT -A FORWARD -m state --state INVALID -j DROP\n\n# \u041e\u0442\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c \u043d\u0443\u043b\u0435\u0432\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b\n$IPT -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n\n# \u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u043c\u0441\u044f \u043e\u0442 syn-flood \u0430\u0442\u0430\u043a\n$IPT -A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n$IPT -A OUTPUT -p tcp ! --syn -m state --state NEW -j DROP\n\n# \u0411\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0430\u0434\u0440\u0435\u0441\u043e\u0432\n#$IPT -A INPUT -s 84.122.21.197 -j REJECT\n\n# \u041f\u0440\u043e\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043f\u043e\u0440\u0442 23543 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u0438 \u043f\u043e\u0440\u0442 3389\n\n#$IPT -t nat -A PREROUTING -p tcp --dport 21 -i ${WAN} -j DNAT --to 10.10.0.3:21\n#$IPT -A FORWARD -i $WAN -d 10.10.0.3 -j ACCEPT\n\n#iptables -t nat -A PREROUTING -p tcp -d 188.130.155.52 --dport 21 -j DNAT --to-destination 10.10.0.3:21\n#iptables -A FORWARD -i $WAN -d 10.10.0.3 -p tcp --dport 21 -j ACCEPT\n\n#$IPT -t nat -A PREROUTING -p tcp -d 188.130.155.52 --dport 49152:65534 -j DNAT --to-destination 10.10.0.3:49152-65534\n#$IPT -A FORWARD -i $WAN -d 10.10.0.3 -p tcp --dport 49152:65534 -j ACCEPT\n\n#iptables -t nat -A PREROUTING -p tcp -d 1.1.1.1 --dport 21 -j DNAT --to-destination 192.168.2.2:21\n#iptables -A FORWARD -i eth0 -d 192.168.2.2 -p tcp --dport 21 -j ACCEPT\n#iptables -t nat -A PREROUTING -p tcp -d 1.1.1.1 --dport 49152:65534 -j DNAT --to-destination 192.168.2.2:49152-65534\n#iptables -A FORWARD -i eth0 -d 192.168.2.2 -p tcp --dport 49152:65534 -j ACCEPT\n\n\n#$IPT -t nat -A PREROUTING -p tcp --dport 53 -i ${WAN} -j DNAT --to 10.10.0.4:53\n#$IPT -A FORWARD -i $WAN -d 10.10.0.4 -j ACCEPT\n#$IPT -t nat -A PREROUTING -p tcp --dport 8080 -i ${WAN} -j DNAT --to 10.10.0.5:8080\n#$IPT -A FORWARD -i $WAN -d 10.10.0.5 -j ACCEPT\n#$IPT -t nat -A PREROUTING -p tcp --dport 38397 -i ${WAN} -j DNAT --to 10.10.0.5:38397\n#$IPT -t nat -A PREROUTING -p tcp --dport 4444 -i ${WAN} -j DNAT --to 10.10.0.5:4444\n\n\n#$IPT -t nat -A PREROUTING -p tcp --dport 80 -i ${WAN} -j DNAT --to 10.10.0.7:80\n#$IPT -A FORWARD -i $WAN -d 10.10.0.7 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u043a\u0438 \u043d\u0430\u0440\u0443\u0436\u0443\n$IPT -A FORWARD -i $LAN1 -o $WAN -j ACCEPT\n\n\n# \u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u0441\u043d\u0430\u0440\u0443\u0436\u0438 \u0432 \u043b\u043e\u043a\u0430\u043b\u043a\u0443\n$IPT -A FORWARD -i $WAN -o $LAN1 -j REJECT\n\n\n# \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u043c NAT\n$IPT -t nat -A POSTROUTING -o $WAN -s $LAN1_IP_RANGE -j MASQUERADE\n#$IPT -t nat -A POSTROUTING -o $WAN -s $LAN2_IP_RANGE -j MASQUERADE\n# \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u043a SSH\n#$IPT -A INPUT -i $WAN -p tcp --dport 22 -j ACCEPT\n\n# \u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u043c\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0443\n#$IPT -A INPUT -p tcp -m tcp --dport 25 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 465 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 110 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 995 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 143 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 993 -j ACCEPT\n\n#\u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u043a web \u0441\u0435\u0440\u0432\u0435\u0440\u0443\n#$IPT -A INPUT -p tcp -m tcp --dport 8080 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 4444 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 21 -j ACCEPT\n#$IPT -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT\n\n\n#\u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u043a DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0443\n#$IPT -A INPUT -i $WAN -p udp --dport 53 -j ACCEPT\n\n# \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\n#$IPT -N block_in\n#$IPT -N block_out\n#$IPT -N block_fw\n\n#$IPT -A INPUT -j block_in\n#$IPT -A OUTPUT -j block_out\n#$IPT -A FORWARD -j block_fw\n\n#$IPT -A block_in -j LOG --log-level info --log-prefix \"--IN--BLOCK\"\n#$IPT -A block_in -j DROP\n#$IPT -A block_out -j LOG --log-level info --log-prefix \"--OUT--BLOCK\"\n#$IPT -A block_out -j DROP\n#$IPT -A block_fw -j LOG --log-level info --log-prefix \"--FW--BLOCK\"\n#$IPT -A block_fw -j DROP\n\n/sbin/iptables-save  \n /etc/iptables.rules\niptables -L -v -n", 
            "title": "Firewall"
        }, 
        {
            "location": "/Linux/", 
            "text": "Debian 9 (stretch)\n\n\nsudo dd if=~/\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0438/debian-9.3.0-amd64-netinst.iso of=/dev/sdb\n\n\nBased configuration\n\n\nYou can use \nDebian Sources List Generator\n. Modify the data in the /etc/apt/sources.list file by new data.\n\n\napt update \n apt upgrade\n\n\napt install sudo net-tools\n\n\nadduser [username] sudo\n or \nvisudo\n + \nusername   ALL=(ALL)   ALL\n\n\napt search [package_name]\n - search the needed packages\n\n\ndpkg-reconfigure tzdata\n - change the timezone\n\n\nnano /etc/profile\n - set command alias for some commands which are often used\n\n\n# add to the end\nalias ll='ls $LS_OPTIONS -l'\nalias l='ls $LS_OPTIONS -lA'\nalias rm='rm -i'\nalias cp='cp -i'\nalias mv='mv -i'\n\n\n\nsource /etc/profile\n\n\nssh-keygen -t ecdsa\n - key generation\n\n\nssh -L PORT:localhost:PORT HOSTNAME\n - ssh tunnel\n\n\nsudo sed -i \"/#.*/d\" /etc/keystone/keystone.conf\n \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u0440\u0435\u0448\u0435\u0442\u043a\u043e\u0439\n\n\nsudo sed -i \"/^$/d\" /etc/keystone/keystone.conf\n \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438\n\n\nNetworking\n\n\nauto virbr0\niface virbr0 inet static\n        address 10.10.0.1/24\n        bridge_ports eno1\n\n\n\napt install firmware-misc-nonfree\n - wi-fi driver\n\n\nauto wlo1\niface wlo1 inet dhcp\nwpa-essid [ssid]\nwpa-psk [passwd]\n\n\n\nroute add -net 10.10.0.0/24 dev mgmt1\n\n\nroute del -net 10.10.0.0/24 dev mgmt1\n\n\nTroubleshooting\n\n\nIf you get GnuPG errors like:\n\n\n\n\nGPG error: [..] Release: The following signatures couldn\u2019t be verified because the public key is not available: NO_PUBKEY [..]\n\n\n\n\napt update 2\n1 | grep -o '[0-9A-Z]{16}$' | xargs\n - try auto update\n\n\negrep -v '^#|^$' /etc/apt/sources.list{,.d/*.list}\n - try to find bad repo and do rm manually\n\n\ngpg --keyserver subkeys.pgp.net --recv KEY\n \n\ngpg --export --armor KEY | sudo apt-key add\n - or add the key manually\n\n\n/etc/apt/trusted.gpg\n - or just removing\n\n\nfuser -vki /var/lib/dpkg/lock\n - to fix error with /var/lib/apt/lists/lock - open", 
            "title": "Linux"
        }, 
        {
            "location": "/Linux/#debian-9-stretch", 
            "text": "sudo dd if=~/\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0438/debian-9.3.0-amd64-netinst.iso of=/dev/sdb", 
            "title": "Debian 9 (stretch)"
        }, 
        {
            "location": "/Linux/#based-configuration", 
            "text": "You can use  Debian Sources List Generator . Modify the data in the /etc/apt/sources.list file by new data.  apt update   apt upgrade  apt install sudo net-tools  adduser [username] sudo  or  visudo  +  username   ALL=(ALL)   ALL  apt search [package_name]  - search the needed packages  dpkg-reconfigure tzdata  - change the timezone  nano /etc/profile  - set command alias for some commands which are often used  # add to the end\nalias ll='ls $LS_OPTIONS -l'\nalias l='ls $LS_OPTIONS -lA'\nalias rm='rm -i'\nalias cp='cp -i'\nalias mv='mv -i'  source /etc/profile  ssh-keygen -t ecdsa  - key generation  ssh -L PORT:localhost:PORT HOSTNAME  - ssh tunnel  sudo sed -i \"/#.*/d\" /etc/keystone/keystone.conf  \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u0440\u0435\u0448\u0435\u0442\u043a\u043e\u0439  sudo sed -i \"/^$/d\" /etc/keystone/keystone.conf  \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438", 
            "title": "Based configuration"
        }, 
        {
            "location": "/Linux/#networking", 
            "text": "auto virbr0\niface virbr0 inet static\n        address 10.10.0.1/24\n        bridge_ports eno1  apt install firmware-misc-nonfree  - wi-fi driver  auto wlo1\niface wlo1 inet dhcp\nwpa-essid [ssid]\nwpa-psk [passwd]  route add -net 10.10.0.0/24 dev mgmt1  route del -net 10.10.0.0/24 dev mgmt1", 
            "title": "Networking"
        }, 
        {
            "location": "/Linux/#troubleshooting", 
            "text": "If you get GnuPG errors like:   GPG error: [..] Release: The following signatures couldn\u2019t be verified because the public key is not available: NO_PUBKEY [..]   apt update 2 1 | grep -o '[0-9A-Z]{16}$' | xargs  - try auto update  egrep -v '^#|^$' /etc/apt/sources.list{,.d/*.list}  - try to find bad repo and do rm manually  gpg --keyserver subkeys.pgp.net --recv KEY   gpg --export --armor KEY | sudo apt-key add  - or add the key manually  /etc/apt/trusted.gpg  - or just removing  fuser -vki /var/lib/dpkg/lock  - to fix error with /var/lib/apt/lists/lock - open", 
            "title": "Troubleshooting"
        }, 
        {
            "location": "/OvS/", 
            "text": "Basic configuration\n\n\n\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0439 \u0432 ovs-sw0, \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c IP-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u044b\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a.\n\n\n\u041e\u0434\u0438\u043d \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043f\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f OvS \u0441\u0432\u0438\u0447\u0435\u043c STP \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430.\n\n\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0431\u0443\u0434\u0443\u0442 \u0430\u0433\u0440\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u044b.\n\n\novs-vsctl add-br ovs-sw0\n\n\novs-vsctl add-port ovs-sw0 eth0\n\n\novs-vsctl add-port ovs-sw0 mgmt0\n\n\novs-vsctl set interface mgmt0 type=internal\n\n\novs-vsctl show\n\n\nnano /etc/network/interfaces\n\n\nauto lo\niface lo inet loopback\n\nauto enp1s0\niface enp1s0 inet manual\n\nallow-hotplug mgmt0\niface mgmt0 inet static\naddress pub_ip/27\ngateway pub_gw\ndns-nameservers 77.88.8.8\n\nallow-hotplug mgmt1\niface mgmt1 inet static\naddress 10.10.0.1/24\n\n\n\novs-vsctl list-br\n\n\novs-vsctl list-ports ovs-sw0\n\n\novs-vsctl del-port ovs-sw0 mgmt0\n\n\novs-vsctl del-br ovs-sw0\n\n\nVLAN\n\n\novs-vsctl set port \n\u0438\u043c\u044f_\u043f\u043e\u0440\u0442\u0430\n tag=10\n\n\novs-vsctl add-br sw0-vlan10 ovs-sw0 10\n\n\n\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u043c \u043f\u043e\u0440\u0442\u0443 eth0 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0432\u043e \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043c\u0438\u0440 \u0442\u0440\u0430\u0444\u0438\u043a \u0438\u0437 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 VLAN-\u043e\u0432:\n\n\novs-vsctl set port eth0 trunks=100,200,300\n\n\n\u0412\u043c\u0435\u0441\u0442\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u044b set, \u043c\u043e\u0433\u0443\u0442 \u0442\u0430\u043a\u0436\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f:\n\n\nlist \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n\nfind \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0443\u0441\u043b\u043e\u0432\u0438\u0435\n\nget \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n\nadd \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n\nremove \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n\nclear \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447\ncreate \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n\ndestroy \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n\nwait-until \n\u0442\u0430\u0431\u043b\u0438\u0446\u0430\n \n\u0437\u0430\u043f\u0438\u0441\u044c\n \n\u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n\n\n\n\n\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430:\n\n\novs-vsctl list port eth0\n\n\n\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e vlan:\n\n\novs-vsctl find port tag=100\n\n\n\u0410\u0433\u0440\u0435\u0433\u0438\u0440\u0443\u0435\u043c \u043b\u0438\u043d\u043a\u0438 (LACP)\n\n\novs-vsctl add-bond \n\u0438\u043c\u044f_\u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440\u0430\n \n\u0438\u043c\u044f_\u043d\u043e\u0432\u043e\u0433\u043e_bonda\n \n\u0441\u043f\u0438\u0441\u043e\u043a_\u0444\u0438\u0437.\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432\n\n\novs-vsctl add-bond ovs-sw0 bond0 eth0 eth1\n\n\novs-vsctl set port bond0 lacp=active\n\n\novs-appctl lacp/show \nbond-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\n\n\nMirroring\n\n\novs-vsctl -- set Bridge xenbr1 mirrors=@m \\\n-- --id=@enp1s0 get Port enp1s0 \\\n-- --id=@mirror1 get Port mirror1 \\\n-- --id=@m create Mirror name=enp1s0-mirror select-dst-port=@enp1s0 \\\nselect-src-port=@enp1s0 output-port=@mirror1", 
            "title": "OvS"
        }, 
        {
            "location": "/OvS/#basic-configuration", 
            "text": "\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0439 \u0432 ovs-sw0, \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c IP-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u044b\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a.  \u041e\u0434\u0438\u043d \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043f\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f OvS \u0441\u0432\u0438\u0447\u0435\u043c STP \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430.  \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0431\u0443\u0434\u0443\u0442 \u0430\u0433\u0440\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u044b.  ovs-vsctl add-br ovs-sw0  ovs-vsctl add-port ovs-sw0 eth0  ovs-vsctl add-port ovs-sw0 mgmt0  ovs-vsctl set interface mgmt0 type=internal  ovs-vsctl show  nano /etc/network/interfaces  auto lo\niface lo inet loopback\n\nauto enp1s0\niface enp1s0 inet manual\n\nallow-hotplug mgmt0\niface mgmt0 inet static\naddress pub_ip/27\ngateway pub_gw\ndns-nameservers 77.88.8.8\n\nallow-hotplug mgmt1\niface mgmt1 inet static\naddress 10.10.0.1/24  ovs-vsctl list-br  ovs-vsctl list-ports ovs-sw0  ovs-vsctl del-port ovs-sw0 mgmt0  ovs-vsctl del-br ovs-sw0", 
            "title": "Basic configuration"
        }, 
        {
            "location": "/OvS/#vlan", 
            "text": "ovs-vsctl set port  \u0438\u043c\u044f_\u043f\u043e\u0440\u0442\u0430  tag=10  ovs-vsctl add-br sw0-vlan10 ovs-sw0 10  \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u043c \u043f\u043e\u0440\u0442\u0443 eth0 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0432\u043e \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043c\u0438\u0440 \u0442\u0440\u0430\u0444\u0438\u043a \u0438\u0437 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 VLAN-\u043e\u0432:  ovs-vsctl set port eth0 trunks=100,200,300  \u0412\u043c\u0435\u0441\u0442\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u044b set, \u043c\u043e\u0433\u0443\u0442 \u0442\u0430\u043a\u0436\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f:  list  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c \nfind  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \nget  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \nadd  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \nremove  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \nclear  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447\ncreate  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \ndestroy  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c \nwait-until  \u0442\u0430\u0431\u043b\u0438\u0446\u0430   \u0437\u0430\u043f\u0438\u0441\u044c   \u043a\u043b\u044e\u0447=\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435   \u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430:  ovs-vsctl list port eth0  \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e vlan:  ovs-vsctl find port tag=100", 
            "title": "VLAN"
        }, 
        {
            "location": "/OvS/#lacp", 
            "text": "ovs-vsctl add-bond  \u0438\u043c\u044f_\u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440\u0430   \u0438\u043c\u044f_\u043d\u043e\u0432\u043e\u0433\u043e_bonda   \u0441\u043f\u0438\u0441\u043e\u043a_\u0444\u0438\u0437.\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432  ovs-vsctl add-bond ovs-sw0 bond0 eth0 eth1  ovs-vsctl set port bond0 lacp=active  ovs-appctl lacp/show  bond-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441", 
            "title": "\u0410\u0433\u0440\u0435\u0433\u0438\u0440\u0443\u0435\u043c \u043b\u0438\u043d\u043a\u0438 (LACP)"
        }, 
        {
            "location": "/OvS/#mirroring", 
            "text": "ovs-vsctl -- set Bridge xenbr1 mirrors=@m \\\n-- --id=@enp1s0 get Port enp1s0 \\\n-- --id=@mirror1 get Port mirror1 \\\n-- --id=@m create Mirror name=enp1s0-mirror select-dst-port=@enp1s0 \\\nselect-src-port=@enp1s0 output-port=@mirror1", 
            "title": "Mirroring"
        }, 
        {
            "location": "/xen/", 
            "text": "Xen installation\n\n\napt-get install xen-system-amd64 xen-tools\n        \n\n\nmv -i /etc/grub.d/20_linux_xen /etc/grub.d/08_linux_xen\n - grub priority\n\n\nupdate-grub\n\n\nxl dmesg | grep VMX\n - to check the virtualization extensions. If not already enabled in BIOS, enable it.\n\n\napt-get install lvm2\n\n\nvgcreate vg0 /dev/sda7\n\n\ndd if=/dev/zero of=ubuntufull.disk bs=1024k count=0 seek=10240\n\n\nConfigure the mirrors.conf and xen-tools.conf files. yyy\n\n\nnano xl.conf\n\n\nvif.default.script=\"vif-openvswitch\"\nvif.default.bridge=\"xenbr0\"\n\n\n\nCreate PV DomU:\n\n\nxen-create-image --hostname=$guest --ip x.x.x.x --netmask x.x.x.x --gateway x.x.x.x --vcpus 2 --dist stretch\n\n\nxen-create-image --hostname=$guest --memory=2gb --vcpus=2 --lvm=vg0 --dhcp --pygrub --dist=stretch\n\n\nnano /etc/xen/$guest.cfg\n\n    vif = [ 'bridge=virbr0', 'bridge=virbr1' ]\n\nxl network-list \nhostname\n\n\nCreate HVM DomU:\n\n\nlvcreate -n name -L 20G lvmgroup\n\n\nnano /etc/xen/web.cfg\n                                                 \n\n\nbuilder = \"hvm\"\nname = \"web-hvm\"\nmemory = \"2048\"\nvcpus = 2\nvif = [ 'script=vif-openvswitch,bridge=xenbr0' ]\ndisk = ['phy:/dev/vg0/web,hda,w','file:/srv/share/ubuntu-14.04.1-server-amd64.iso,hdc:cdrom,r']\n#disk = ['phy:/dev/vg0/web,hda,w']\nvnc = 1\n#boot=\"c\"\nboot=\"dc\"\n\n\n\nxl list\n\n\nxl create /etc/xen/\nhostname\n.cfg\n\n\nxl console \nhostname\n\n\nxl restart \nhostname\n\n\nxen-delete-image VMs_name --lvm=vg01\n\n\nCold Migration\n\n\nxl save \ndomain id\n \nsavefile\n\n\nscp \nsavefile\n \ntarget.domain.tld:/path/\n\n\nxl restore \nsavefile\n\n\nLive Migration\n\n\nnano /etc/xen/xend-config.sxp\n\n\n(xend-relocation-server yes)\n\n\n\n/etc/init.d/xend restart\n\n\nxl migrate \ndomain id\n \ndestination machine\n\n\nHA Cluster\n\n\nxl remus -F -n -d 6 10.10.0.20", 
            "title": "Xen"
        }, 
        {
            "location": "/xen/#xen-installation", 
            "text": "apt-get install xen-system-amd64 xen-tools           mv -i /etc/grub.d/20_linux_xen /etc/grub.d/08_linux_xen  - grub priority  update-grub  xl dmesg | grep VMX  - to check the virtualization extensions. If not already enabled in BIOS, enable it.  apt-get install lvm2  vgcreate vg0 /dev/sda7  dd if=/dev/zero of=ubuntufull.disk bs=1024k count=0 seek=10240  Configure the mirrors.conf and xen-tools.conf files. yyy  nano xl.conf  vif.default.script=\"vif-openvswitch\"\nvif.default.bridge=\"xenbr0\"  Create PV DomU:  xen-create-image --hostname=$guest --ip x.x.x.x --netmask x.x.x.x --gateway x.x.x.x --vcpus 2 --dist stretch  xen-create-image --hostname=$guest --memory=2gb --vcpus=2 --lvm=vg0 --dhcp --pygrub --dist=stretch  nano /etc/xen/$guest.cfg \n    vif = [ 'bridge=virbr0', 'bridge=virbr1' ] xl network-list  hostname  Create HVM DomU:  lvcreate -n name -L 20G lvmgroup  nano /etc/xen/web.cfg                                                    builder = \"hvm\"\nname = \"web-hvm\"\nmemory = \"2048\"\nvcpus = 2\nvif = [ 'script=vif-openvswitch,bridge=xenbr0' ]\ndisk = ['phy:/dev/vg0/web,hda,w','file:/srv/share/ubuntu-14.04.1-server-amd64.iso,hdc:cdrom,r']\n#disk = ['phy:/dev/vg0/web,hda,w']\nvnc = 1\n#boot=\"c\"\nboot=\"dc\"  xl list  xl create /etc/xen/ hostname .cfg  xl console  hostname  xl restart  hostname  xen-delete-image VMs_name --lvm=vg01", 
            "title": "Xen installation"
        }, 
        {
            "location": "/xen/#cold-migration", 
            "text": "xl save  domain id   savefile  scp  savefile   target.domain.tld:/path/  xl restore  savefile", 
            "title": "Cold Migration"
        }, 
        {
            "location": "/xen/#live-migration", 
            "text": "nano /etc/xen/xend-config.sxp  (xend-relocation-server yes)  /etc/init.d/xend restart  xl migrate  domain id   destination machine", 
            "title": "Live Migration"
        }, 
        {
            "location": "/xen/#ha-cluster", 
            "text": "xl remus -F -n -d 6 10.10.0.20", 
            "title": "HA Cluster"
        }
    ]
}